<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pralo Chess Tournament</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
      .first-place {
        background-color: green;
        color: white;
      }
      .last-place {
        background-color: red;
        color: white;
      }
    </style>
  </head>
  <body>
    <table class="table table-hover" id="playersTable" style="margin-top: 20px;">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">JOUEURS</th>
          <th scope="col">POINTS</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">1</th>
          <td>Valoup</td>
          <td>0</td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>Alizou d'amour</td>
          <td>0</td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>Agathe</td>
          <td>0</td>
        </tr>
        <tr>
          <th scope="row">4</th>
          <td>Kauè</td>
          <td>0</td>
        </tr>
        <tr>
          <th scope="row">5</th>
          <td>Évariste</td>
          <td>0</td>
        </tr>
      </tbody>
    </table>
    <h1 style="text-align: center;">Calendrier des matchs :</h1>
    <div style="text-align: center;">
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Alizou d'amour"> Alizou d'amour
        <input type="checkbox" class="match-checkbox" data-winner="Valoup"> Valoup
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Évariste"> Évariste
        <input type="checkbox" class="match-checkbox" data-winner="Kauè"> Kauè
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Valoup"> Valoup
        <input type="checkbox" class="match-checkbox" data-winner="Agathe"> Agathe
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Alizou d'amour"> Alizou d'amour
        <input type="checkbox" class="match-checkbox" data-winner="Kauè"> Kauè
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Agathe"> Agathe
        <input type="checkbox" class="match-checkbox" data-winner="Évariste"> Évariste
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Évariste"> Évariste
        <input type="checkbox" class="match-checkbox" data-winner="Alizou d'amour"> Alizou d'amour
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Agathe"> Agathe
        <input type="checkbox" class="match-checkbox" data-winner="Kauè"> Kauè
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Valoup"> Valoup
        <input type="checkbox" class="match-checkbox" data-winner="Évariste"> Évariste
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Agathe"> Agathe
        <input type="checkbox" class="match-checkbox" data-winner="Alizou d'amour"> Alizou d'amour
      </div>
      <br>
      <div>
        <input type="checkbox" class="match-checkbox" data-winner="Valoup"> Valoup
        <input type="checkbox" class="match-checkbox" data-winner="Kauè"> Kauè
      </div>
    </div>
    <div style="text-align: center; margin-top: 20px;">
      <button id="resetButton" class="btn btn-danger">Réinitialiser</button>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const table = document.getElementById('playersTable').getElementsByTagName('tbody')[0];
        let rows = Array.from(table.rows);

        const players = rows.map(row => {
          const cells = row.getElementsByTagName('td');
          return {
            row: row,
            name: cells[0].innerText,
            points: parseInt(cells[1].innerText, 10)
          };
        });

        const loadPoints = () => {
          const savedPoints = JSON.parse(localStorage.getItem('playerPoints')) || {};
          players.forEach(player => {
            if (savedPoints[player.name] !== undefined) {
              player.points = savedPoints[player.name];
            }
          });
        };

        const savePoints = () => {
          const points = {};
          players.forEach(player => {
            points[player.name] = player.points;
          });
          localStorage.setItem('playerPoints', JSON.stringify(points));
        };

        const sortAndUpdateTable = () => {
          players.sort((a, b) => b.points - a.points);

          players.forEach((player, index) => {
            player.row.cells[0].innerText = index + 1;
            player.row.cells[1].innerText = player.name;
            player.row.cells[2].innerText = player.points;
            player.row.classList.remove('first-place', 'last-place');
            if (index === 0) {
              player.row.classList.add('first-place');
            } else if (index === players.length - 1) {
              player.row.classList.add('last-place');
            }
            table.appendChild(player.row);
          });
        };

        const updatePoints = (winnerName) => {
          players.forEach(player => {
            if (player.name === winnerName) {
              player.points += 3;
            }
          });
          savePoints();
          sortAndUpdateTable();
        };

        const resetPoints = () => {
          players.forEach(player => {
            player.points = 0;
          });
          savePoints();
          sortAndUpdateTable();
          document.querySelectorAll('.match-checkbox').forEach(checkbox => {
            checkbox.checked = false;
            checkbox.disabled = false;
          });
        };

        document.querySelectorAll('.match-checkbox').forEach(checkbox => {
          checkbox.addEventListener('change', (event) => {
            if (event.target.checked) {
              const winnerName = event.target.getAttribute('data-winner');
              updatePoints(winnerName);
              event.target.disabled = true;
            }
          });
        });

        document.getElementById('resetButton').addEventListener('click', resetPoints);

        loadPoints();
        sortAndUpdateTable();
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
